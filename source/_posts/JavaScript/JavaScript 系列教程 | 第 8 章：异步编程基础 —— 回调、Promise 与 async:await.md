---
title: JavaScript ç³»åˆ—æ•™ç¨‹ | ç¬¬ 8 ç« ï¼šå¼‚æ­¥ç¼–ç¨‹åŸºç¡€ â€”â€” å›è°ƒã€Promise ä¸ async/await
description: "\U0001F680 æœ¬ç« å°†ç”¨æœ€é€šä¿—æ˜“æ‡‚çš„è¯­è¨€ï¼Œç»“åˆå¤§é‡ç¤ºä¾‹å’Œæµç¨‹å›¾ï¼Œæ·±å…¥è®²è§£ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ŒåŒ…æ‹¬å›è°ƒå‡½æ•°ã€Promise ä»¥åŠ async/awaitï¼Œå¸®åŠ©ä½ å½»åº•ç†è§£å¼‚æ­¥çš„åŸç†ä¸å®æˆ˜ã€‚"
keywords: 'JavaScript, å¼‚æ­¥ç¼–ç¨‹, å›è°ƒ, Promise, async/await, äº‹ä»¶å¾ªç¯'
top_img: /images/post/js/JavaScript.avif
cover: /images/post/js/JavaScript.avif
categories: 
  - JavaScript
tags: 
  - æ•™ç¨‹ 
  - JavaScript
date: '2025-06-13 16:52'
abbrlink: 39211
---

## ä¸€ã€å¼€åœºç™½è¯ï¼šä¸ºä»€ä¹ˆè¦å­¦å¼‚æ­¥ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å»é¤å…ç‚¹é¤ã€‚ä½ ä¸ä¼šåœ¨ç‚¹å®Œèœåä¸€ç›´ç«™ç€ç­‰å¨å¸ˆåšå®Œèœæ‰å¹²åˆ«çš„äº‹ï¼Œè€Œæ˜¯å…ˆå»æ‰¾æœ‹å‹èŠå¤©ï¼Œæˆ–è€…ç©æ‰‹æœºï¼Œç­‰èœå¥½äº†ï¼ŒæœåŠ¡å‘˜å†å«ä½ å–é¤ã€‚
è¿™å°±æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„æœ¬è´¨â€”â€”**ä¸ä¼šå› ä¸ºæŸä¸ªä»»åŠ¡æ²¡å®Œæˆè€Œé˜»å¡åç»­æ“ä½œ**ã€‚

JavaScript æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¸€æ¬¡åªèƒ½å¹²ä¸€ä»¶äº‹ã€‚å¦‚æœé‡åˆ°è€—æ—¶æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€è¯»æ–‡ä»¶ç­‰ï¼‰é˜»å¡ï¼Œå°±ä¼šè®©é¡µé¢å¡æ­»ï¼Œä½“éªŒéå¸¸å·®ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJavaScript å‘æ˜äº†â€œå¼‚æ­¥ç¼–ç¨‹â€æœºåˆ¶ï¼Œè®©è€—æ—¶ä»»åŠ¡åœ¨åå°è·‘ï¼Œå®Œæˆåå†é€šçŸ¥ä¸»çº¿ç¨‹ç»§ç»­å¤„ç†ã€‚

---

## äºŒã€å¼‚æ­¥çš„ä¸‰ç§ç»å…¸å®ç°æ–¹å¼

* å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰
* Promise å¯¹è±¡
* async/await è¯­æ³•ç³–

ä¸‹é¢æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ¥èŠã€‚

---

## ä¸‰ã€å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰

### 1. ä»€ä¹ˆæ˜¯å›è°ƒï¼Ÿ

ç®€å•æ¥è¯´ï¼Œå›è°ƒå‡½æ•°å°±æ˜¯æŠŠä¸€ä¸ªå‡½æ•°å½“ä½œå‚æ•°ï¼Œä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œè®©å®ƒâ€œå®Œæˆä»»åŠ¡åå†å¸®ä½ è°ƒç”¨â€ã€‚

### 2. å°æ•…äº‹ï¼šæ‰“åŒ…å¿«é€’å›è°ƒ

å‡å¦‚ä½ å¯„å¿«é€’ï¼Œç»™å¿«é€’å‘˜ä¸€ä¸ªç”µè¯ï¼Œè®©ä»–é€è¾¾åæ‰“ç”µè¯å‘Šè¯‰ä½ â€œå¿«é€’å·²é€è¾¾â€ï¼Œä½ æŠŠç”µè¯ç»™äº†å¿«é€’å‘˜ï¼Œè¿™ä¸ªç”µè¯å°±æ˜¯å›è°ƒå‡½æ•°ã€‚

### 3. ç¤ºä¾‹ä»£ç ï¼š

```js
function fetchData(callback) {
  setTimeout(() => {
    const data = { name: 'å°æ˜', age: 18 };
    callback(data);  // ä»»åŠ¡å®Œæˆåè°ƒç”¨å›è°ƒå‡½æ•°
  }, 2000);  // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚è€—æ—¶2ç§’
}

console.log('å¼€å§‹è¯·æ±‚æ•°æ®...');
fetchData(function(result) {
  console.log('æ”¶åˆ°æ•°æ®:', result);
});
console.log('è¯·æ±‚å‘å‡ºï¼Œç»§ç»­æ‰§è¡Œåç»­ä»£ç ');
```

ğŸ§  **æµç¨‹è§£é‡Š**ï¼š

* `fetchData` æ¨¡æ‹Ÿäº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œ2ç§’åè¿”å›æ•°æ®ã€‚
* åœ¨è¿™2ç§’é‡Œï¼Œä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚
* 2ç§’åï¼Œ`callback` è¢«è°ƒç”¨ï¼Œè¾“å‡ºæ”¶åˆ°çš„æ•°æ®ã€‚

### 4. å›è°ƒçš„ç¼ºç‚¹

* å¦‚æœå¤šå±‚åµŒå¥—ï¼Œä»£ç ä¼šå˜å¾—å¾ˆéš¾çœ‹ï¼Œä¿—ç§°â€œå›è°ƒåœ°ç‹±â€ã€‚
* é”™è¯¯å¤„ç†å¤æ‚ï¼Œå®¹æ˜“æ¼æ‰å¼‚å¸¸ã€‚

---

## å››ã€Promise â€”â€” å¼‚æ­¥çš„æ–°å¸Œæœ›

### 1. Promise æ˜¯ä»€ä¹ˆï¼Ÿ

Promise å°±åƒæ˜¯ä¸€å¼ â€œä»»åŠ¡æ‰¿è¯ºå¡â€ï¼Œä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰çš„ç»“æœã€‚

### 2. Promise ä¸‰ç§çŠ¶æ€

* **Pendingï¼ˆè¿›è¡Œä¸­ï¼‰**ï¼šåˆšå¼€å§‹ï¼Œå¼‚æ­¥ä»»åŠ¡è¿˜æ²¡å®Œæˆã€‚
* **Fulfilledï¼ˆå·²æˆåŠŸï¼‰**ï¼šä»»åŠ¡æˆåŠŸå®Œæˆã€‚
* **Rejectedï¼ˆå·²å¤±è´¥ï¼‰**ï¼šä»»åŠ¡å¤±è´¥ã€‚

### 3. å°æ•…äº‹ï¼šè®¢é¤æ‰¿è¯ºå¡

ä½ ç»™é¤å…è®¢äº†é¤ï¼Œä»–ä»¬ç»™ä½ ä¸€å¼ â€œæ‰¿è¯ºå¡â€ï¼Œå‘Šè¯‰ä½ â€œæˆ‘ä¼šåœ¨30åˆ†é’Ÿå†…é€è¾¾æˆ–è€…å‘Šè¯‰ä½ å‡ºé”™äº†â€ã€‚è¿™å¼ å¡å°±æ˜¯ Promiseã€‚

### 4. Promise åŸºæœ¬ç”¨æ³•ç¤ºä¾‹

```js
function fetchData() {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const success = true;  // æ¨¡æ‹Ÿè¯·æ±‚æˆåŠŸæˆ–å¤±è´¥
      if (success) {
        resolve({ name: 'å°æ˜', age: 18 });  // æˆåŠŸæ—¶è°ƒç”¨ resolve
      } else {
        reject('è¯·æ±‚å¤±è´¥');  // å¤±è´¥æ—¶è°ƒç”¨ reject
      }
    }, 2000);
  });
}

console.log('å¼€å§‹è¯·æ±‚æ•°æ®...');
fetchData()
  .then(result => {
    console.log('è¯·æ±‚æˆåŠŸ:', result);
  })
  .catch(error => {
    console.error('è¯·æ±‚å¤±è´¥:', error);
  });
console.log('è¯·æ±‚å‘å‡ºï¼Œç»§ç»­æ‰§è¡Œåç»­ä»£ç ');
```

ğŸ§  **æ‰§è¡Œæµç¨‹**ï¼š

* `fetchData` è¿”å›ä¸€ä¸ª Promiseï¼Œè¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡ã€‚
* ä»»åŠ¡å®Œæˆæ—¶è°ƒç”¨ `resolve` æˆ– `reject`ï¼Œé€šçŸ¥ç»“æœã€‚
* é€šè¿‡ `.then()` ç»‘å®šæˆåŠŸå›è°ƒï¼Œ`.catch()` ç»‘å®šå¤±è´¥å›è°ƒã€‚
* ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œä¸è¢«é˜»å¡ã€‚

### 5. Promise ä¼˜åŠ¿

* é“¾å¼è°ƒç”¨é¿å…å›è°ƒåœ°ç‹±
* é”™è¯¯ç»Ÿä¸€æ•è·æ›´æ–¹ä¾¿

---

## äº”ã€async/await â€”â€” å†™å¼‚æ­¥å°±åƒå†™åŒæ­¥

### 1. async/await æ˜¯ä»€ä¹ˆï¼Ÿ

å®ƒæ˜¯åŸºäº Promise çš„è¯­æ³•ç³–ï¼Œè®©ä½ ç”¨åŒæ­¥ä»£ç çš„æ–¹å¼å†™å¼‚æ­¥ï¼Œä»£ç æ›´ç®€æ´æ˜“è¯»ã€‚

### 2. å°æ•…äº‹ï¼šè¯·å‡åŠäº‹æµç¨‹

ä½ å†™äº†ä¸€å°è¯·å‡æ¡ï¼ˆasync å‡½æ•°ï¼‰ï¼Œäº¤ç»™é¢†å¯¼å®¡æ‰¹ï¼ˆawait ç­‰å¾…ç»“æœï¼‰ï¼Œå®¡æ‰¹é€šè¿‡åå†å»åšä¸‹ä¸€æ­¥äº‹ã€‚æ•´ä¸ªæµç¨‹çœ‹èµ·æ¥åƒæ˜¯åŒæ­¥è¿›è¡Œï¼Œä½†å…¶å®é¢†å¯¼å®¡æ‰¹æ˜¯å¼‚æ­¥çš„ã€‚

### 3. ä»£ç ç¤ºä¾‹

```js
function fetchData() {
  return new Promise(resolve => {
    setTimeout(() => {
      resolve({ name: 'å°æ˜', age: 18 });
    }, 2000);
  });
}

async function getData() {
  console.log('å¼€å§‹è¯·æ±‚æ•°æ®...');
  const result = await fetchData();  // ç­‰å¾… Promise å®Œæˆ
  console.log('æ”¶åˆ°æ•°æ®:', result);
  console.log('æ•°æ®å¤„ç†å®Œæˆ');
}

getData();
console.log('è¯·æ±‚å‘å‡ºï¼Œç»§ç»­æ‰§è¡Œåç»­ä»£ç ');
```

ğŸ§  **æ‰§è¡Œæµç¨‹**ï¼š

* `getData` æ˜¯å¼‚æ­¥å‡½æ•°ï¼Œé‡åˆ° `await` è¯­å¥æš‚åœæ‰§è¡Œï¼Œç­‰å¾… `fetchData` è¿”å›ç»“æœã€‚
* è¿™æœŸé—´ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œåé¢çš„åŒæ­¥ä»£ç ã€‚
* Promise å®Œæˆåï¼Œ`getData` æ¢å¤æ‰§è¡Œã€‚

---

## å…­ã€äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰æµ…æ â€”â€” å¼‚æ­¥èƒŒåçš„ç§˜å¯†

![äº‹ä»¶å¾ªç¯æµç¨‹å›¾](https://cdn.jsdelivr.net/gh/wanghaoze/images/img/2022/03/event-loop.jpg)

> äº‹ä»¶å¾ªç¯å°±åƒå¨å¸ˆçš„è®°äº‹æœ¬ï¼Œè®°å½•ä»»åŠ¡é¡ºåºï¼Œç¡®ä¿å¼‚æ­¥ä»»åŠ¡æŒ‰è§„åˆ™ä¾æ¬¡å®Œæˆã€‚

### 1. ä»»åŠ¡é˜Ÿåˆ—çš„ä¸¤å¤§åˆ†ç±»

* **å®ä»»åŠ¡ï¼ˆMacro Taskï¼‰**ï¼šå¦‚ä¸»ä»£ç ã€`setTimeout`ã€`setInterval`
* **å¾®ä»»åŠ¡ï¼ˆMicro Taskï¼‰**ï¼šå¦‚ Promise çš„ `.then()`ã€`process.nextTick`ï¼ˆNode.jsï¼‰

### 2. æ‰§è¡Œæµç¨‹ç®€è¿°

* æ‰§è¡Œä¸»çº¿ç¨‹ä»£ç ï¼ˆå®ä»»åŠ¡ï¼‰
* æ‰§è¡Œå®Œæ¯•åï¼Œæ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡
* æ¸²æŸ“é¡µé¢
* è¿›å…¥ä¸‹ä¸€ä¸ªå®ä»»åŠ¡å¾ªç¯

è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆ Promise çš„ `.then()` ä¼šæ¯” `setTimeout` å…ˆæ‰§è¡Œã€‚

---

## ä¸ƒã€å¼‚æ­¥ç¼–ç¨‹ç»¼åˆç¤ºä¾‹ï¼šè¯·æ±‚æ•°æ®å¹¶å¤„ç†

```js
function getUser() {
  return new Promise(resolve => {
    setTimeout(() => resolve({ id: 1, name: 'å°æ˜' }), 1000);
  });
}

function getPosts(userId) {
  return new Promise(resolve => {
    setTimeout(() => resolve([{ id: 101, content: 'ç¬¬ä¸€ç¯‡æ–‡ç« ' }]), 1000);
  });
}

async function showUserPosts() {
  try {
    const user = await getUser();  // ç­‰å¾…ç”¨æˆ·ä¿¡æ¯
    console.log('ç”¨æˆ·:', user);
    const posts = await getPosts(user.id);  // ç­‰å¾…ç”¨æˆ·å¸–å­
    console.log('å¸–å­åˆ—è¡¨:', posts);
  } catch (error) {
    console.error('è¯·æ±‚å‡ºé”™:', error);
  }
}

showUserPosts();
```

ğŸ§  **æ•°æ®æµç¨‹**ï¼š

| æ—¶é—´ | æ“ä½œ                    | æ•°æ®æ ·å­                                 |
| ---- | ----------------------- | ---------------------------------------- |
| 0s   | è°ƒç”¨ `showUserPosts`    | â€”                                        |
| 1s   | `getUser` è¿”å›ç”¨æˆ·æ•°æ®  | `{ id: 1, name: 'å°æ˜' }`                |
| 2s   | `getPosts` è¿”å›å¸–å­åˆ—è¡¨ | `[ { id: 101, content: 'ç¬¬ä¸€ç¯‡æ–‡ç« ' } ]` |

---

## å…«ã€æ€»ç»“

* å¼‚æ­¥ç¼–ç¨‹æ˜¯ JavaScript å¼€å‘ä¸­ä¸å¯ç»•è¿‡çš„é‡è¦è¯¾é¢˜ã€‚
* å›è°ƒæ˜¯æœ€åŸå§‹çš„å¼‚æ­¥å®ç°ï¼Œä½†å®¹æ˜“é€ æˆâ€œå›è°ƒåœ°ç‹±â€ã€‚
* Promise å¸¦æ¥é“¾å¼è°ƒç”¨å’Œæ›´å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚
* async/await è®©å¼‚æ­¥ä»£ç åƒåŒæ­¥ä¸€æ ·å†™ï¼Œæå‡å¯è¯»æ€§ã€‚
* ç†è§£äº‹ä»¶å¾ªç¯èƒ½å¸®åŠ©ä½ æ›´å¥½ç†è§£å¼‚æ­¥æ‰§è¡Œé¡ºåºã€‚

---

## ä¹ã€æ¨èé˜…è¯» & å‚è€ƒèµ„æ–™

* ğŸ“˜ [é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— - JavaScript å¼‚æ­¥ç¼–ç¨‹](https://www.ruanyifeng.com/blog/2015/05/async.html)
* ğŸ“— [MDN - Promise](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise)
* ğŸ“— [MDN - async function](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/async_function)
* ğŸ“˜ [æå®¢æ—¶é—´ã€ŠJavaScriptå¼‚æ­¥ç¼–ç¨‹å®æˆ˜ã€‹ä¸“æ ](https://time.geekbang.org/column/intro/100042501)
* ğŸ“˜ [èœé¸Ÿæ•™ç¨‹ - JavaScript å¼‚æ­¥](https://www.runoob.com/js/js-async.html)

---

å¦‚æœä½ éœ€è¦æˆ‘å¸®ä½ å†™ç¬¬9ç« æˆ–è€…è¡¥å……æµç¨‹å›¾åŠ¨ç”»ï¼Œä¹Ÿéšæ—¶å‘Šè¯‰æˆ‘ï¼
